<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->

<link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="css/bootstrap-select.min.css">
  </head>
  <body>
  <input type="hidden" id="totalpages" value="0" />
	<input type="hidden" id="nextpage" value="1" />
	<input type="hidden" id="activesearch" value="1" />
	<select id="setaddress" style="display:none;"></select>
<div class="row-fluid first-set eventlist"></div>
<!-- footer -->
<!-- Modal -->
<div class="menu-model">
<div class="modal fade" id="exampleModalLong" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
  <div class="modal-dialog main-part" role="document">
    <div class="modal-content inner-part">
    
      <div class="modal-body">
      <button type="button" class="close clse-set" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        <div class="main-nav-bar">
            <ul class="inner-nav-bar">
  <li><img src="images/GuestUserIcon.png" class="img-fluid" alt="Responsive image"><a href="#">MY PROFILE</a></li>
<li><!-- <img src="images/event.png" class="img-fluid" alt="Responsive image"> --><i class="fa fa-calendar-check-o fa-lg" aria-hidden="true"></i><a href="#">EVENTS</a></li>
<li><img src="images/openwork.png" class="img-fluid" alt="Responsive image"><a href="#">OPEN WORK SPACES & CAFEâ€™S</a></li>
 <li><!-- <img src="images/coworking.png" class="img-fluid" alt="Responsive image"> --><i class="fa fa-university fa-lg" aria-hidden="true"></i><a href="#">Coworking spaces</a></li>
  <li><!-- <img src="images/iam.png" class="img-fluid" alt="Responsive image"> --><i class="fa fa-heart fa-lg" aria-hidden="true"></i><a href="#">EVENTS I AM FOLLOWING</a></li>
 <li><!-- <img src="images/rating.png" class="img-fluid" alt="Responsive image"> --><i class="fa fa-star fa-lg" aria-hidden="true"></i><a href="#">MY RATINGS</a></li>
 <li><img src="images/logout.png" class="img-fluid" alt="Responsive image"><a href="#">LOG OUT</a></li>


            </ul>

        </div>
      </div>
      <!-- <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div> -->
    </div>
  </div>
</div>
</div>



<!-- filter model -->

<div class="filter-model">
<div class="modal fade filtermodelbox" id="exampleModalLong1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle1" aria-hidden="true">
  <div class="modal-dialog main-part" role="document">
    <div class="modal-content inner-part">
    
      <div class="modal-body">
      <button type="button" class="close clse-set" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
       
<div class="event-filter">
  <h2>filters</h2>
  <div class="ratings-filter">
    <h4>ratings</h4>


<div class="radio red">
  <label><input type="radio" value="rating_DESC" name="order_by">high to low</label>
</div>
<div class="radio black">
  <label><input type="radio" value="rating_ASC" name="order_by">low to high</label>
</div>
</div>


<div class="ratings-filter">
 <h4>DATE</h4>
<div class="radio red">
  <label><input type="radio" value="startdate_ASC" checked="checked" name="order_by">New to Old</label>
</div>
<div class="radio black">
  <label><input type="radio" value="startdate_DESC" name="order_by">Old to New</label>
</div>
</div>

<div class="ratings-filter showhidelocationfilter">
 <h4>LOCATION</h4>
<div class="radio red">
  <label><input type="radio" value="location_ASC" name="order_by">Near to Far</label>
</div>
<div class="radio black">
  <label><input type="radio" value="location_DESC" name="order_by">Far to Near</label>
</div>
</div>


  
</div>





      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary filter-button">Filter</button>
      </div>
    </div>
  </div>
</div>
</div>

<!-- filter model end -->
  
    

<div class="foter-main">
    <ul class="footer-parts">
        <li class="oneset-foot"><button type="button" class="btn btn-primary toogle-footer" data-toggle="modal" data-target="#exampleModalLong">
  <img src="images/toogle.png" class="img-fluid" alt="Responsive image">
</button> </li>
        <li class="second-search-for"><input type="text" name="srchtxt" id="srchtxt" style="display:none;" /><a href="javascript:;" class="showsearchtxt"><img src="images/search.png" class="img-fluid" alt="Responsive image"></a></li>
        <li class="three-set-foot"><button type="button" class="btn btn-primary toogle-footer" data-toggle="modal" data-target="#exampleModalLong1"><img src="images/filter.png" class="img-fluid" alt="Responsive image"></button></li>

		<li class="backbtn" style="display:none;"><a href="javascript:;"><img src="images/back.png" class="img-fluid" alt="Responsive image"></a></li>
    </ul>
</div>

<!-- footer-close -->

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="js/jquery-3.2.1.slim.min.js"></script>

    <script src="js/popper.min.js" ></script>

    <script src="js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/jquery.js"></script>
	<script type="text/javascript" charset="utf-8" src="cordova.js"></script>
	<script type="text/javascript" src="js/config.js"></script>
	<script type="text/javascript" src="js/bootstrap-select.min.js"></script>
	<script type="text/javascript">
	function showlocations()
	{
		var uid=localStorage.getItem('User_ID');
		var url=siteurl+'/api/events';
		jQuery.ajax({ 
		 type: 'POST',  
		 url: url,  
		 //contentType: contentType,  
		 dataType: 'json',  
		 data: {getlocation:1,user_id:uid},  
		 crossDomain: true,  
		 beforeSend: function() {
		 },		
		 complete: function() {
		 },
		 success: function(res) { 
		 	jQuery('#setaddress').show();
			var html='<option value="">Select Location</option>';
			var lati=localStorage.getItem('User_Lat');
 			if(typeof lati!='undefined' && lati!=null && lati!=''){
				var html='<option value="currentlocation">Use my current location</option>';
			}
		   if(res['responce'])
		   {
				jQuery(res['responce']).each(function(index){
					html+='<option value="'+res['responce'][index]['setaddress']+'">'+res['responce'][index]['showaddress']+'</option>';
					
			   });
			}
			
			jQuery('#setaddress').html(html);
			var setaddress=localStorage.getItem('Event_setaddress');
 			if(typeof setaddress!='undefined' && setaddress!=null && setaddress!=''){
				jQuery('#setaddress').val(setaddress);
			}
			 jQuery('#setaddress').selectpicker({'liveSearch':true,'showTick':true, 'showSubtext':true});
		 },  
		 error: function(response, d, a){
			
			
		 } 
	   });
	}
	showlocations();
	function showevents()
	{
		jQuery( document ).on( "mobileinit", function() {
			jQuery.mobile.allowCrossDomainPages = true;
		});
		var contentType ="application/x-www-form-urlencoded; charset=utf-8";
		if(window.XDomainRequest){contentType = "text/plain";}
		jQuery.support.cors = true;
		var order_by=jQuery('input[name="order_by"]:checked').val();
		var setaddress=jQuery('#setaddress').val();
		var presetaddress=localStorage.getItem('Event_setaddress');
		if(typeof presetaddress!='undefined' && presetaddress!=null && presetaddress!='' && jQuery.trim(setaddress)==''){
			setaddress=presetaddress;
		}
		
		
		//var order_location=jQuery('input[name="order_location"]:checked').val();
		var srchtxt=jQuery('#srchtxt').val();
		var uid=localStorage.getItem('User_ID');
		var url=siteurl+'/api/events';
		var latitude=localStorage.getItem('User_Lat');
		if(typeof latitude=='undefined' || latitude==null){latitude='';}
		var longitude=localStorage.getItem('User_Long');
		if(typeof longitude=='undefined' || longitude==null){longitude='';}
		var totalpages=jQuery('#totalpages').val();
		var pageid=jQuery('#nextpage').val();
		var activesearch=jQuery('#activesearch').val();
		if(activesearch=='1'){
			jQuery.ajax({ 
			 type: 'POST',  
			 url: url,  
			 contentType: contentType,  
			 dataType: 'json',  
			 data: {order_by:order_by,srchtxt:srchtxt,page:pageid,user_id:uid, latitude:latitude, longitude:longitude,setaddress:setaddress},  
			 crossDomain: true,  
			 beforeSend: function() {
				
				jQuery('#activesearch').val(0);						
			 },		
			 complete: function() {
							
			 },
			 success: function(res) { 
			 	var html=''; 
			   if(res['responce'])
			   {
					
					
					jQuery(res['responce']).each(function(index){
						html+='<div class="main-one"><a href="event-detail.html?uid='+uid+'&event_id='+res['responce'][index]['id']+'"><p class="main-heading-event">'+res['responce'][index]['name']+'</p></a><div class="inner-section-event">';
						if(res['responce'][index]['photo']!=''){
							html+='<a href="event-detail.html?uid='+uid+'&event_id='+res['responce'][index]['id']+'"><img src="'+res['responce'][index]['photo']+'" class="img-fluid img-set-one" alt="'+res['responce'][index]['name']+'"></a>';
						}
					html+='<div class="inner-two">';
					
					  html+='<div class="last-inner-set"><div class="ist-div">';
					  if(res['responce'][index]['address']!='' && res['responce'][index]['address']!=null){
					  html+='<a href="event-detail.html?uid='+uid+'&event_id='+res['responce'][index]['id']+'#gmap"><i class="fa fa-map-marker fa-lg locatio-map" aria-hidden="true"></i></a><p><a href="event-detail.html?uid='+uid+'&event_id='+res['responce'][index]['id']+'"><b>'+res['responce'][index]['address']+'</b></a></p>';
					  }
                      html+='</div>';
					  
					  html+='<div class="last-circles"><ul class="rating-ul">';
					  		var remainrates=5;
					  		if(res['responce'][index]['ratings']!='' && res['responce'][index]['ratings']!='0'){
								for(var i=0;i<res['responce'][index]['ratings'];i++){
                              		html+='<a href="javascript:;"><li class="rating-active"></li></a>';
								}
								remainrates=5-parseInt(res['responce'][index]['ratings']);
							}
							for(var i=0;i<remainrates;i++){
								html+='<a href="javascript:;"><li></li></a>';
							}
                             
                        html+='</ul><ul class="next-view">';
             			if(res['responce'][index]['rate']!='' && res['responce'][index]['rate']=='Yes'){
                              html+='<li class="heart-like"><a href="javascript:;"><i class="fa fa-heart-o  fa-lg" aria-hidden="true"></i></a> </li>';
						}
                       html+='<li class="eye-show"><a href="event-detail.html?uid='+uid+'&event_id='+res['responce'][index]['id']+'"><i class="fa fa-eye  fa-lg" aria-hidden="true"></i></a></li></ul></div></div>';
                  		html+='<div class="second-last-event-set"><p><span>'+res['responce'][index]['startdate']+'</span></p></div></div></div></div>';
						
				   });
				   jQuery('#activesearch').val(1);
				   
				   if(pageid==1){
						jQuery('#totalpages').val(res['totalpage']);
						if(res['totalpage']==1){jQuery('#activesearch').val(0);}
						localStorage.setItem('Event_list',html);
						jQuery('.eventlist').html('');
						
				   }
				  else if(parseInt(totalpages)>=pageid){
						if(totalpages==1){jQuery('#activesearch').val(0);}
				   }
				   else
				   {
				   		jQuery('#activesearch').val(0);
				   }
				   pageid=parseInt(pageid)+1;
				   	jQuery('#nextpage').val(pageid);
				}
				if(jQuery.trim(html)==''){
				html='<p class="noitemfound">There is no event found.</p>';
				if(pageid==1){jQuery('.eventlist').html(html);localStorage.setItem('Event_list',html);}
				}
				else{
				   jQuery('.eventlist').append(html);
				 }
			 },  
			 error: function(response, d, a){
			 	
				jQuery('body .bodyoverlay').remove();
				jQuery('body .popupbox').remove();
				var html='<div class="bodyoverlay"></div><div class="popupbox errorbox"><div class="popupimg"><img src="images/error.png" /></div><h1 class="success">ERROR</h1><h1>Server Error.</h1><button class="okbox">OK</button></div>';
				jQuery('body').append(html);
				
				jQuery('.okbox').click(function(){
					jQuery('body .bodyoverlay').remove();
					jQuery('body .popupbox').remove();
				}); 
			 } 
		   });
		}
	}
	
	jQuery(document).ready(function(){
		var Event_list=localStorage.getItem('Event_list');
		if(typeof Event_list!='undefined' && Event_list!=null && Event_list!=''){
			jQuery('.eventlist').append(Event_list);
		}
		jQuery( document ).on( "mobileinit", function() {
			jQuery.mobile.allowCrossDomainPages = true;
		});
		var contentType ="application/x-www-form-urlencoded; charset=utf-8";
		if(window.XDomainRequest){contentType = "text/plain";}
		jQuery.support.cors = true;
		jQuery('a.showsearchtxt').click(function(){
			if(!jQuery(this).hasClass('active'))
			{
				jQuery('.backbtn').show();
				jQuery('#srchtxt').show();
				jQuery(this).addClass('active');
				jQuery('.footer-parts').addClass('showingsrchfield');
				jQuery('body').addClass('srchfieldbody');
			}
			else
			{
				
				jQuery('.eventlist .main-one').remove();
				jQuery('#totalpages').val(0);
				jQuery('#nextpage').val(1);
				jQuery('#activesearch').val(1);
				showevents();
			}
		});
		jQuery('.backbtn a').click(function(){
			jQuery('#srchtxt').hide();
			jQuery('a.showsearchtxt').removeClass('active');
			jQuery('.footer-parts').removeClass('showingsrchfield');
			jQuery('body').removeClass('srchfieldbody');
			jQuery('#totalpages').val(0);
			jQuery('#nextpage').val(1);
			jQuery('#activesearch').val(1);
			jQuery(this).parent('li').hide();
			jQuery('#srchtxt').val('');
			jQuery('.eventlist').html('');
			showevents();
		});
		jQuery('button.filter-button').click(function(){
			jQuery('.eventlist .main-one').remove();
			jQuery('#totalpages').val(0);
			jQuery('#nextpage').val(1);
			jQuery('#activesearch').val(1);
			showevents();
			jQuery('#exampleModalLong1 .modal-body button.close').trigger('click');
		});
		jQuery('#setaddress').change(function(){
			localStorage.setItem('Event_setaddress',jQuery(this).val());
			jQuery('#totalpages').val(0);
			jQuery('#nextpage').val(1);
			jQuery('#activesearch').val(1);
			jQuery('.eventlist').html('');
			showevents();
			
			
		});
		
		showevents();
		
		$(window).scroll(function() {
		   if($(window).scrollTop() + $(window).height() > $(document).height() - 100) {
				showevents();
		   }
		});
		setTimeout(function(){jQuery('li.eventmenu').addClass('active')},1500);
	});
	var onSuccess = function(position) {
		
		localStorage.setItem('User_Lat',position.coords.latitude);
		localStorage.setItem('User_Long',position.coords.longitude);
		
    };
 function onError(error) {
        jQuery('.showhidelocationfilter').hide();
    }
   var lati=localStorage.getItem('User_Lat');
 if(typeof lati=='undefined' || lati==null || lati==''){
 jQuery('.showhidelocationfilter').hide();
    navigator.geolocation.getCurrentPosition(onSuccess, onError);
	
}
	</script>
  </body>
</html>